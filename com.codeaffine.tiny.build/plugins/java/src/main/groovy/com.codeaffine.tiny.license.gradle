import java.time.LocalDate

plugins {
    id("com.codeaffine.tiny.base")
    id("com.diffplug.spotless")
}

spotless {
    java {
        licenseHeaderFile project.parent.file("COPYRIGHT.txt")
    }
}

tasks.register('addMainLicense', Copy) {
    if(needLicenceFile(project, 'main', "${projectDir}/src/main/")) {
        from(project.parent.file('LICENSE'))
        into("${projectDir}/src/main/resources/META-INF")
    }
}

private static boolean needLicenceFile(Project project, sourceSetName, sourceSetDir) {
    def result = false
    project.sourceSets.each {
        result |= it.name == sourceSetName && new File(sourceSetDir).exists()
    }
    return result
}
